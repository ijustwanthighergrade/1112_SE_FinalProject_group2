<!DOCTYPE html>
<html lang="en">
    {% load static %}
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seller Analysis</title>
    <link href="{% static "css/seller.css" %}" rel="stylesheet">   
    <link href="{% static "css/all.css" %}" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">    
    {% comment %} <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.0/chart.min.js" integrity="sha512-R60W3LgKdvvfwbGbqKusRu/434Snuvr9/Flhtoq9cj1LQ9P4HFKParULqOCAisHk/J4zyaEWWjiWIMuP13vXEg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> {% endcomment %}
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    {% comment %} <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.min.js" integrity="sha512-3dZ9wIrMMij8rOH7X3kLfXAzwtcHpuYpEgQg1OA4QAob1e81H8ntUQmQm3pBudqIoySO5j0tHN4ENzA6+n2r4w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>   {% endcomment %}
    <link rel="shortcut icon" href="#" />
    {% comment %} <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script> {% endcomment %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.3.0/chart.min.js" integrity="sha512-mlz/Fs1VtBou2TrUkGzX4VoGvybkD9nkeXWJm3rle0DPHssYYx4j+8kIS15T78ttGfmOjH0lLaBXGcShaVkdkg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
    {% comment %} <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script> {% endcomment %}
    {% comment %} <script src="{% static 'js/seller_page/piechart.js' %}"></script> {% endcomment %}
    {% comment %} <script src="{% static 'js/seller_page/piechart2.js' %}"></script> {% endcomment %}
    <script src="{% static 'js/seller_page/lineChart1.js' %}"></script>
    <script src="{% static 'js/seller_page/lineChart2.js' %}"></script>
    {% comment %} <script src="{% static 'js/seller_page/donutchart.js' %}"></script> {% endcomment %}
    <script src="{% static 'js/seller_page/donutchart1.js' %}"></script>
    <script src="{% static 'js/seller_page/donutchart2.js' %}"></script>
    <script src="{% static 'js/seller_page/donutchart3.js' %}"></script>
    <script src="{% static 'js/seller_page/donutchart4.js' %}"></script>
    {% comment %} <script src="{% static 'js/seller_page/barchart.js' %}"></script> {% endcomment %}
    <script src="{% static 'js/seller_page/calender.js' %}"></script>
    <script src="{% static 'js/seller_page/seller_selected.js' %}"></script>
    {% comment %} <script src="{% static 'js/seller_page/costomer_selected.js' %}"></script> {% endcomment %}

</head>
<body>
      {% include 'header.html' %}
    <div class="seller_container">
        <div class="container_select ">
            <div class="container_table ">
            <table class="seller_select">
                <tr class="selected_title ">
                <td>業務員編號</td>
                </tr>
                {% for Sp_id in all_Sp_id %} 
                <tr>
                    <td>
                        <button class="btn" data-spid="{{ Sp_id.Sp_id}}">{{ Sp_id.Sp_id }}</button>
                    </td>
                </tr>
                {% endfor %}
              </table>
        
            </div>
        </div>
        <div class="container_top ">
            {% comment %} <div class="cardarea ">
                <div class="cardarea_text ">
                    客戶資料蒐集完成度
                </div>

            </div> {% endcomment %}
            <div class="container_select_small">
                <div class="container_table ">
                    <table class="seller_select " id="cus_select">
                        <tr id="cus_title" class="selected_title ">
                            <td>客戶編號</td>
                        </tr>
                        {% for Cus_id in all_Cus_id %} 
                        <tr>
                            <td>
                                <button class="btn_cus" data-cusid="{{ Cus_id.Cus_id}}">{{ Cus_id.Cus_id }}</button>
                            </td>
                        </tr>
                        {% endfor %}

                    </table>
                </div>
            </div>
            <div class="achartarea " id="myDiv">
                <div class="cusiddataframe_cardarea">
                    <div class="cusiddataframe_text">
                        業務員資料蒐集完整度
                    </div>
                </div>
                <div class="cusiddataframe_cardarea_button">
                    <div class="cusiddataframe_cardarea_button_text" id="selectedrate">
                        {{selectedrate}}%
                    </div>
                </div>
                
                <table class="cusiddataframe">
                    <tr>
                        <td>
                            客戶id
                        </td>
                    </tr>
                    <tr>
                        <td id="Cus_id_id">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            家庭成員數量
                        </td>
                    </tr>
                    <tr>
                        <td id="Cus_FamilyNum">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            長者有無
                        </td>
                    </tr>
                    <tr>
                        <td id="Cus_eld">

                        </td>
                    </tr>
                    <tr>
                        <td>
                            家中是否有按摩椅
                        </td>
                    </tr>
                    <tr>
                        <td id="Chair_status">

                        </td>
                    </tr>
                    <tr>
                        <td>
                            客戶消費預算下限
                        </td>
                    </tr>
                    <tr>
                        <td id="Chair_floor">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            客戶消費預算上限
                        </td>
                    </tr>
                    <tr>
                        <td id="Chair_ceiling">

                        </td>
                    </tr>
                    <tr>
                        <td>
                            主要按摩部位需求
                        </td>
                    </tr>
                    <tr>
                        <td id="Chair_position">

                        </td>
                    </tr>
                    <tr>
                        <td>
                            顏色偏好
                        </td>
                    </tr>
                    <tr>
                        <td id="Chair_color">

                        </td>
                    </tr>
                    <tr>
                        <td>
                            過去消費過的品牌產品
                        </td>
                    </tr>
                    <tr>
                        <td id="Cus_PastItem">

                        </td>
                    </tr>
                    <tr>
                        <td>
                            按摩模式力道偏好
                        </td>
                    </tr>
                    <tr>
                        <td id="Chair_power">

                        </td>
                    </tr>
                    <tr>
                        <td>
                            客戶職業
                        </td>
                    </tr>
                    <tr>
                        <td id="Cus_job">

                        </td>
                    </tr>
                    <tr>
                        <td>
                            過去買過的產品
                        </td>
                    </tr>
                    <tr>
                        <td id="product_past">

                        </td>
                    </tr>
                </table>
                {% comment %} <canvas id="myChart"></canvas> {% endcomment %}
            </div>
            <div class="chartarea ">
                <canvas id="mypieChart"></canvas>
            </div>
            <div class="chartarea ">
                <canvas id="mypieChart1"></canvas>
            </div>
            <div class="cardarea ">
                <div class="cardarea_text ">
                    業務員成交客戶類型
                </div>
            </div> 
            <div class="stacked_barchart_area ">
                <canvas id="mybarChart"></canvas>
            </div>
        </div>
        <div class="container_button ">
            <div class="container_button_left ">
                <div class="container_button_inside">
                    
                <div class="container_button_right_divide ">
                    <div class="mylineChart_text"> 

                        <div class="cardarea_text ">
                            各階段客戶數量
                        </div>
                    </div>  

                    <div class="mylineChart_chart">
                        <canvas id="mylineChart"></canvas>
                    </div>
                    
                </div>
                
                <div class="container_button_right_divide ">
                     <div class="mylineChart_text">
                        <div class="cardarea_text ">
                            各月成交案件數
                        </div>
                    </div>  
                    <div class="mylineChart_chart">
                        <canvas id="mylineChart2"></canvas>
                    </div>
                   
                </div>
                </div>
                <div class="container_top_inside ">
                    
                    <div class="small_chartarea ">
                        <canvas id="myChart1"></canvas>
                    </div>
                    {% comment %} <div class="mydonutChart_text"> 
                        <div class="cardarea_text ">
                            第二階段成敗率
                        </div>
                    </div>  {% endcomment %}
                    <div class="small_chartarea ">
                        <canvas id="myChart2"></canvas>
                    </div>
                    <div class="small_chartarea ">
                        <canvas id="myChart3"></canvas>
                    </div>
                    <div class="small_chartarea ">
                        <canvas id="myChart4"></canvas>
                    </div>
                </div>
            </div>
            <div class="container_button_right ">
                
                <div class="calander_text">
                    <div class="cardarea_text ">
                        業務員值勤表
                    </div>
                </div>  
                <div class="calendar">
                    <div id="calendar">
                        <div class="calendar-header">
                          <button id="prev-month">&lt;</button>
                          <span id="current-month"></span>
                          <button id="next-month">&gt;</button>
                        </div>
                        <table class="calendar-table">
                          <thead>
                            <tr>
                              <th>日</th>
                              <th>一</th>
                              <th>二</th>
                              <th>三</th>
                              <th>四</th>
                              <th>五</th>
                              <th>六</th>
                            </tr>
                          </thead>
                          <tbody id="calendar-body">
                            <!-- 使用JavaScript生成日期行 -->
                          </tbody>
                        </table>
                      </div>

                        
                        <!-- 弹出框 -->
                        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">日期</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                                </div>
                                <div class="modal-body" id="modal-content">
                                    誰值班
                                </div>
                                <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">關閉</button>
                                </div>
                            </div>
                            </div>
                        </div>
  
                      
                      
                </div>
                  
                <div class="title_cardarea">
                    <div class="top_cardarea">
                        <div class="cardcaption">
                            目前選擇之業務員
                        </div>
                        <div class="title_cardarea_text" id="selected_spid">
                            所有業務員
                        </div>
                    </div>
                    <div class="top_cardarea">
                        <div class="cardcaption">目前選擇之客戶
                        </div>
                        <div class="title_cardarea_text" id="selected_cusid">
                            無
                        </div>
                    </div>
                    <div class="top_cardarea">
                        <div class="cardcaption">
                        </div>
                        <div class="title_cardarea_bigtext">
                            業務分析
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
    {% comment %} {{allsp_turnover}} {% endcomment %}
    {% comment %} {{false_labels}} {% endcomment %}
    {{counter}}
</body>
</html>
<script>
    var endpoint = '../api/chart/data/'
    var defaultData=[]
    var labels=[]
    {% for spid in all_Sp_id %}
        labels.push("{{spid.Sp_id}}")
    {%endfor%}
    {% for sp_turnover in allsp_turnover %}
        defaultData.push("{{sp_turnover}}")
    {%endfor%}
    setpieChart();
    {% comment %} $.ajax({
        method: 'GET',
        url: endpoint,
        success: function(data){
            labels = data.labels
            defaultData = data.default    
            setpieChart();
        },
        error: function(error_data){
            console.log('error'); 
        }
    }) {% endcomment %}
    function setpieChart(){
        var ctx = document.getElementById("mypieChart"); 
        var mypieChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels, // 這裡
                datasets: [{
                    label: '# of Votes',
                    data: defaultData, // 和這裡
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            fontSize:allfontsize ,
                            beginAtZero:true
                        }
                        ,
                    }]
                },
                plugins:{
                    legend: {
                            usePointStyle: true, // 使用点样式来表示标签的颜色框
                            pointStyle: 'circle', // 将点的样式设置为圆形
                            pointRadius: 6, // 设置标签框的半径
                            pointHoverRadius: 8, // 设置鼠标悬停时标签框的半径
                            display: true,
                            position: 'top',
                            align: 'end',
                            labels: {
                              fontColor: '#333',
                              fontSize: 5,
                              boxWidth: 8,
                              padding: 4
                            }
                    },
                    title:{
                        display: true,
                        text:"業務員貢獻營業額佔比",
                        position:'top',
                        align:'top'
                    }
                }
            }
        });
    }

    flaselabels = []
    falsedefaultData = []
    {% for false_labels in false_keys_list %}
        flaselabels.push("{{false_labels}}")
    {%endfor%}
    falsedefaultData={{false_values_list}}
    setpieChart1();
    function setpieChart1(){
        var ctx = document.getElementById("mypieChart1"); 
        var mypieChart1 = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: flaselabels, // 這裡
                datasets: [{
                    label: '# of Votes',
                    data: falsedefaultData, // 和這裡
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            fontSize:allfontsize ,
                            beginAtZero:true
                        }
                        ,
                    }]
                },
                plugins:{
                    legend: {
                            usePointStyle: true, // 使用点样式来表示标签的颜色框
                            pointStyle: 'circle', // 将点的样式设置为圆形
                            pointRadius: 6, // 设置标签框的半径
                            pointHoverRadius: 8, // 设置鼠标悬停时标签框的半径
                            display: true,
                            position: 'top',
                            align: 'end',
                            labels: {
                              fontColor: '#333',
                              fontSize: 5,
                              boxWidth: 8,
                              padding: 4
                            }
                    },
                    title:{
                        display: true,
                        text:"業務員失敗因素占比",
                        position:'top',
                        align:'top'
                    }
                }
            }
        });
    }


    oknolabels = ['成功','失敗']
    defaultDatastate=[70,30]
    function setoptions(name){

        options={
            scales: {
                yAxes: [{
                    ticks: {
                        fontSize:allfontsize ,
                        beginAtZero:true
                    }
                    ,
                }]
            },
            plugins:{
                legend: {
                        usePointStyle: true, // 使用点样式来表示标签的颜色框
                        pointStyle: 'circle', // 将点的样式设置为圆形
                        pointRadius: 6, // 设置标签框的半径
                        pointHoverRadius: 8, // 设置鼠标悬停时标签框的半径
                        display: true,
                        position: 'top',
                        align: 'end',
                        labels: {
                          fontColor: '#333',
                          fontSize: 5,
                          boxWidth: 35,
                          padding: 4
                        }
                },
                title:{
                    display: true,
                    text:name,
                    position:'top',
                    align:'top'
                }
            }
        }
    
    }
    
    setoptions("第一階段成敗率")  
    setdonutChart();
        
    function setdonutChart(){
        var ctx = document.getElementById("myChart1"); 
        var myChart1 = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: oknolabels, // 這裡
                datasets: [{
                    label: '# of Votes',
                    data: defaultDatastate, // 和這裡
                    backgroundColor: [
                    'rgb(198, 226, 229)',
                    'rgb(255, 255, 255)',
                    ],
                    borderColor: [
                        'rgb(0, 109, 121)',
                    ],
                    borderWidth: 1
                }]
            },
            options: options
        });
    }


    setoptions("第二階段成敗率")  
    setdonutChart2();
    function setdonutChart2(){
        var ctx = document.getElementById("myChart2"); 
        var myChart2 = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: oknolabels, // 這裡
                datasets: [{
                    label: '# of Votes',
                    data: defaultDatastate, // 和這裡
                    backgroundColor: [
                    'rgb(198, 226, 229)',
                    'rgb(255, 255, 255)',
                    ],
                    borderColor: [
                        'rgb(0, 109, 121)',
                    ],
                    borderWidth: 1
                }]
            },
            options: options
        });
    }




    setoptions("第三階段成敗率")  
    setdonutChart3();
    function setdonutChart3(){
        var ctx = document.getElementById("myChart3"); 
        var myChart3 = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: oknolabels, // 這裡
                datasets: [{
                    label: '# of Votes',
                    data: defaultDatastate, // 和這裡
                    backgroundColor: [
                        'rgb(198, 226, 229)',
                        'rgb(255, 255, 255)',
                    ],
                    borderColor: [
                        'rgb(0, 109, 121)',
                    ],
                    borderWidth: 1
                }]
            },
            options: options
        });
    }


    setoptions("第四階段成敗率")  
    setdonutChart4();
    function setdonutChart4(){
        var ctx = document.getElementById("myChart4"); 
        var myChart4 = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: oknolabels, // 這裡
                datasets: [{
                    label: '# of Votes',
                    data: defaultDatastate, // 和這裡
                    backgroundColor: [
                    'rgb(198, 226, 229)',
                    'rgb(255, 255, 255)',
                    ],
                    borderColor: [
                        'rgb(0, 109, 121)',
                    ],
                    borderWidth: 1
                }]
            },
            options: options
        });
    }


    setlineChart();
    var statelabels=['第一階段','第二階段','第三階段','第四階段']
    var statedefaultData =[3,5,8,2]
function setlineChart(){
    var ctx = document.getElementById("mylineChart"); 
    var mylineChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: statelabels, // 這裡
            datasets: [
                {
                    label: '# of Votes',
                    data: statedefaultData, // 和這裡
                    backgroundColor: [
                        'rgb(243, 177, 178)',
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)',
                    ],
                    borderWidth: 1
                },
                {
                    label: '# of Votes',
                    data: statedefaultData, // 和這裡
                    backgroundColor: [
                        'rgb(198, 226, 229)',
                    ],
                    borderColor: [
                        'rgba(153, 102, 255, 1)',
                    ],
                    borderWidth: 1
                }
            ]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        fontSize:allfontsize ,
                        beginAtZero:true
                    }
                }]
            }
        }
    });
}




setbarChart();
var defaultData=[]
var labels=[]

function setbarChart(){
    var ctx = document.getElementById("mybarChart"); 
    var mybarChart = new Chart(ctx, {
        type: 'bar',
        data: {
            axis: 'y',
            labels: labels, // 這裡
            datasets: [
            {
                label: '# of Votes',
                data: defaultData, // 和這裡
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(255, 159, 64, 0.2)',
                    'rgba(255, 205, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(201, 203, 207, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(255, 159, 64, 0.2)',
                    'rgba(255, 205, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(201, 203, 207, 0.2)'
                ],
                borderWidth: 1
            },
            { 
                label: '# of Votes',
                data: defaultData, // 和這裡
                backgroundColor: [
                    'rgba(235, 39, 132, 0.2)',
                    'rgba(53, 132, 235, 0.2)',
                    'rgba(235, 236, 83, 0.2)',
                    'rgba(73, 132, 132, 0.2)',
                    'rgba(155, 132, 235, 0.2)',
                    'rgba(235, 139, 34, 0.2)'
                ],
                borderColor: [
                    'rgba(235,99,135,1)',
                    'rgba(54, 132, 235, 1)',
                    'rgba(255, 246, 86, 1)',
                    'rgba(75, 142, 192, 1)',
                    'rgba(153, 142, 255, 1)',
                    'rgba(255, 154, 64, 1)'
                ],
                borderWidth: 1
            }
            ]
        },
        options: {
            indexAxis: 'y',
            scales: {
                x: {
                    stacked: true
                },
                y: {
                    stacked: true
                }
            },
            title:{
                display: true,
                position:'left',
                align:'top'
            }
        }
    });
}
</script>